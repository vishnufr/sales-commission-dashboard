(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{81451:function(e,t,s){Promise.resolve().then(s.bind(s,36767))},36767:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var l=s(57437),a=s(2265),n=s(89620),o=s(57341),i=s(14482),r=s(3548),d=s(47625),c=s(77031),x=s(56940),m=s(97059),p=s(62994),h=s(22190),j=s(8147),u=s(31699);let f=(0,i.FD)();function g(e){return"".concat((100*e).toFixed(1),"%")}function N(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0})}function b(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function v(){let[e,t]=(0,a.useState)("all"),[s,v]=(0,a.useState)("all"),[y,w]=(0,a.useState)("all"),[S,A]=(0,a.useState)("all"),[C,k]=(0,a.useState)("all"),[D,T]=(0,a.useState)("all"),[R,_]=(0,a.useState)(!1),[M,B]=(0,a.useState)("closer"),[O,W]=(0,a.useState)("cl1"),[z,E]=(0,a.useState)("cl2"),[F,K]=(0,a.useState)("morning"),[I,L]=(0,a.useState)("evening"),U=(0,a.useMemo)(()=>f.filter(t=>("all"===e||t.closerId===e)&&("all"===s||(0,r.A2)(t.callAt)===s)&&("all"===y||(0,r.Hq)(t.callAt)===y)&&("all"===S||t.appointmentType===S)&&("all"===C||t.bookingSource===C)&&("all"===D||t.nurtureType===D)),[e,s,y,S,C,D]),q=(0,a.useMemo)(()=>R?"closer"===M?"all"===O?U:U.filter(e=>e.closerId===O):"all"===F?U:U.filter(e=>(0,r.A2)(e.callAt)===F):U,[R,M,U,O,F]),$=(0,a.useMemo)(()=>R?"closer"===M?"all"===z?U:U.filter(e=>e.closerId===z):"all"===I?U:U.filter(e=>(0,r.A2)(e.callAt)===I):[],[R,M,U,z,I]),H=(0,a.useMemo)(()=>(0,r.z6)(q),[q]),P=(0,a.useMemo)(()=>(0,r.Tb)(q),[q]),G=(0,a.useMemo)(()=>(0,r.z6)($),[$]),J=(0,a.useMemo)(()=>(0,r.Tb)($),[$]),Q=H.totalAppointments>0?H.totalCancelled/H.totalAppointments:0,V=H.totalAppointments>0?H.totalNoShows/H.totalAppointments:0,X=(()=>{let e=q.filter(e=>"closed_won"===e.dealStage&&"number"==typeof e.salesCycleDays);return e.length?e.reduce((e,t)=>{var s;return e+(null!==(s=t.salesCycleDays)&&void 0!==s?s:0)},0)/e.length:0})(),Y=H.totalAppointments>0?P.totalRevenue/H.totalAppointments:0,Z=H.totalShows>0?P.totalRevenue/H.totalShows:0,ee=G.totalAppointments>0?G.totalCancelled/G.totalAppointments:0,et=G.totalAppointments>0?G.totalNoShows/G.totalAppointments:0,es=(()=>{let e=$.filter(e=>"closed_won"===e.dealStage&&"number"==typeof e.salesCycleDays);return e.length?e.reduce((e,t)=>{var s;return e+(null!==(s=t.salesCycleDays)&&void 0!==s?s:0)},0)/e.length:0})(),el=G.totalAppointments>0?J.totalRevenue/G.totalAppointments:0,ea=G.totalShows>0?J.totalRevenue/G.totalShows:0,en=e=>{let t={morning:"Morning (6–12)",afternoon:"Afternoon (12–5)",evening:"Evening (5–9)",night:"Night (9–6)"},s={morning:{total:0,won:0},afternoon:{total:0,won:0},evening:{total:0,won:0},night:{total:0,won:0}};for(let t of e){let e=(0,r.A2)(t.callAt);s[e].total+=1,"closed_won"===t.dealStage&&(s[e].won+=1)}return["morning","afternoon","evening","night"].map(e=>({key:e,label:t[e],appointments:s[e].total,closedWon:s[e].won}))},eo=(0,a.useMemo)(()=>en(q),[q]),ei=(0,a.useMemo)(()=>en($),[$]),er=(0,a.useMemo)(()=>{let e={morning:"Morning (6–12)",afternoon:"Afternoon (12–5)",evening:"Evening (5–9)",night:"Night (9–6)"};return["morning","afternoon","evening","night"].map(t=>{var s,l;let a=eo.find(e=>e.key===t),n=ei.find(e=>e.key===t);return{bucket:e[t],aClosedWon:null!==(s=null==a?void 0:a.closedWon)&&void 0!==s?s:0,bClosedWon:null!==(l=null==n?void 0:n.closedWon)&&void 0!==l?l:0}})},[eo,ei]),ed=(0,a.useMemo)(()=>q.filter(e=>["closed_won","closed_lost"].includes(e.dealStage)).sort((e,t)=>new Date(t.callAt).getTime()-new Date(e.callAt).getTime()).slice(0,8),[q]),ec=(0,a.useMemo)(()=>$.filter(e=>["closed_won","closed_lost"].includes(e.dealStage)).sort((e,t)=>new Date(t.callAt).getTime()-new Date(e.callAt).getTime()).slice(0,8),[$]);return(0,l.jsx)(n.r,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,l.jsx)("header",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight",children:"Analytics"}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Deep dive into appointments, outcomes, and economics. Turn on comparison to benchmark closers or time-of-day windows."})]})}),(0,l.jsx)(o.S,{closerId:e,onCloserChange:t,timeOfDay:s,onTimeOfDayChange:v,dayOfWeek:y,onDayOfWeekChange:w,appointmentType:S,onAppointmentTypeChange:A,bookingSource:C,onBookingSourceChange:k,nurtureType:D,onNurtureTypeChange:T,comparisonEnabled:R,onToggleComparison:()=>_(e=>!e)}),R&&(0,l.jsxs)("section",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4 space-y-3",children:[(0,l.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Comparison settings"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Compare two closers, or two time-of-day windows, inside the current filters."})]})}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,l.jsx)("span",{className:"text-[11px] text-slate-400",children:"Compare by:"}),(0,l.jsx)("button",{type:"button",onClick:()=>B("closer"),className:"text-[11px] px-3 py-1 rounded-full border transition ".concat("closer"===M?"border-indigo-500 bg-indigo-500/10 text-indigo-200":"border-slate-700 text-slate-300 hover:border-slate-500"),children:"Closer"}),(0,l.jsx)("button",{type:"button",onClick:()=>B("timeOfDay"),className:"text-[11px] px-3 py-1 rounded-full border transition ".concat("timeOfDay"===M?"border-indigo-500 bg-indigo-500/10 text-indigo-200":"border-slate-700 text-slate-300 hover:border-slate-500"),children:"Time of day"})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2 mt-2",children:[(0,l.jsxs)("div",{className:"bg-slate-950/60 border border-slate-800 rounded-xl p-3 text-xs space-y-2",children:[(0,l.jsx)("p",{className:"text-[11px] font-semibold text-indigo-300",children:"Segment A"}),"closer"===M?(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-[11px] text-slate-400",children:"Closer"}),(0,l.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-md px-2 py-1 text-[11px] text-slate-100",value:O,onChange:e=>W(e.target.value),children:[i.KF.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)),(0,l.jsx)("option",{value:"all",children:"All closers"})]})]}):(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-[11px] text-slate-400",children:"Time of day"}),(0,l.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-md px-2 py-1 text-[11px] text-slate-100",value:F,onChange:e=>K(e.target.value),children:[(0,l.jsx)("option",{value:"morning",children:"Morning (6–12)"}),(0,l.jsx)("option",{value:"afternoon",children:"Afternoon (12–5)"}),(0,l.jsx)("option",{value:"evening",children:"Evening (5–9)"}),(0,l.jsx)("option",{value:"night",children:"Night (9–6)"}),(0,l.jsx)("option",{value:"all",children:"All times"})]})]})]}),(0,l.jsxs)("div",{className:"bg-slate-950/60 border border-slate-800 rounded-xl p-3 text-xs space-y-2",children:[(0,l.jsx)("p",{className:"text-[11px] font-semibold text-emerald-300",children:"Segment B"}),"closer"===M?(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-[11px] text-slate-400",children:"Closer"}),(0,l.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-md px-2 py-1 text-[11px] text-slate-100",value:z,onChange:e=>E(e.target.value),children:[i.KF.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)),(0,l.jsx)("option",{value:"all",children:"All closers"})]})]}):(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-[11px] text-slate-400",children:"Time of day"}),(0,l.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-md px-2 py-1 text-[11px] text-slate-100",value:I,onChange:e=>L(e.target.value),children:[(0,l.jsx)("option",{value:"morning",children:"Morning (6–12)"}),(0,l.jsx)("option",{value:"afternoon",children:"Afternoon (12–5)"}),(0,l.jsx)("option",{value:"evening",children:"Evening (5–9)"}),(0,l.jsx)("option",{value:"night",children:"Night (9–6)"}),(0,l.jsx)("option",{value:"all",children:"All times"})]})]})]})]})]}),(0,l.jsxs)("section",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4 space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Segment A metrics"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Base filters + Segment A selection."})]}),(0,l.jsxs)("span",{className:"text-[10px] text-indigo-300",children:[q.length," calls"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2 text-xs",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Total appointments"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:H.totalAppointments})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Show-up rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(H.showRate)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Close rate (on shows)"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(H.closeRateOnShows)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Cancel rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(Q)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"No-show rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(V)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Avg days in sales cycle"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:X.toFixed(1)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue (closed won)"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(P.totalRevenue)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue per call"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(Y)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue per show"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(Z)})]})]})]}),R&&(0,l.jsxs)("div",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4 space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Segment B metrics"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Base filters + Segment B selection."})]}),(0,l.jsxs)("span",{className:"text-[10px] text-emerald-300",children:[$.length," calls"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2 text-xs",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Total appointments"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:G.totalAppointments})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Show-up rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(G.showRate)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Close rate (on shows)"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(G.closeRateOnShows)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Cancel rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(ee)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"No-show rate"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:g(et)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Avg days in sales cycle"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:es.toFixed(1)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue (closed won)"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(J.totalRevenue)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue per call"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(el)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Revenue per show"}),(0,l.jsx)("p",{className:"font-semibold text-slate-100",children:N(ea)})]})]})]})]}),(0,l.jsxs)("section",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4 space-y-3",children:[(0,l.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Time-of-day performance"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Closed won deals by time of day. When comparison is on, both segments are overlaid."})]})}),(0,l.jsx)("div",{className:"h-64",children:(0,l.jsx)(d.h,{width:"100%",height:"100%",children:(0,l.jsxs)(c.v,{data:er,margin:{top:10,right:10,left:0,bottom:0},children:[(0,l.jsx)(x.q,{strokeDasharray:"3 3",stroke:"#1f2937"}),(0,l.jsx)(m.K,{dataKey:"bucket",tick:{fontSize:11,fill:"#9ca3af"},axisLine:{stroke:"#4b5563"}}),(0,l.jsx)(p.B,{tick:{fontSize:11,fill:"#9ca3af"},axisLine:{stroke:"#4b5563"},allowDecimals:!1}),(0,l.jsx)(h.D,{wrapperStyle:{fontSize:"10px",color:"#9ca3af"}}),(0,l.jsx)(j.u,{cursor:{fill:"transparent"},contentStyle:{backgroundColor:"#020617",border:"1px solid #ffffffff",borderRadius:"0.5rem",fontSize:"0.75rem"},labelStyle:{color:"#e5e7eb"},itemStyle:{color:"#f9fafb"},formatter:e=>[String(e),"Closed won deals"]}),(0,l.jsx)(u.$,{dataKey:"aClosedWon",name:R?"Segment A closed won":"Closed won deals",radius:[4,4,0,0],fill:"#6366f1"}),R&&(0,l.jsx)(u.$,{dataKey:"bClosedWon",name:"Segment B closed won",radius:[4,4,0,0],fill:"#22c55e"})]})})})]}),(0,l.jsxs)("section",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Recent deals – Segment A"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Closed won and lost after Segment A filters."})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-xs",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-slate-800",children:[(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Date / time"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Closer"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Stage"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Amount"})]})}),(0,l.jsxs)("tbody",{children:[ed.map(e=>(0,l.jsxs)("tr",{className:"border-b border-slate-900 last:border-0",children:[(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:b(e.callAt)}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:e.closerName}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] capitalize whitespace-nowrap ".concat("closed_won"===e.dealStage?"text-emerald-400":"text-rose-400"),children:e.dealStage.replace("_"," ")}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:e.amount?N(e.amount):"-"})]},e.id)),0===ed.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:4,className:"py-2 text-[11px] text-slate-500",children:"No deals found for Segment A."})})]})]})})]}),R&&(0,l.jsxs)("div",{className:"bg-slate-900/60 border border-slate-800 rounded-2xl p-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sm font-medium",children:"Recent deals – Segment B"}),(0,l.jsx)("p",{className:"text-[11px] text-slate-400",children:"Closed won and lost after Segment B filters."})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-xs",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-slate-800",children:[(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Date / time"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Closer"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Stage"}),(0,l.jsx)("th",{className:"py-1.5 px-2 text-left text-[11px] text-slate-400",children:"Amount"})]})}),(0,l.jsxs)("tbody",{children:[ec.map(e=>(0,l.jsxs)("tr",{className:"border-b border-slate-900 last:border-0",children:[(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:b(e.callAt)}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:e.closerName}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] capitalize whitespace-nowrap ".concat("closed_won"===e.dealStage?"text-emerald-400":"text-rose-400"),children:e.dealStage.replace("_"," ")}),(0,l.jsx)("td",{className:"py-1.5 px-2 text-[11px] text-slate-200 whitespace-nowrap",children:e.amount?N(e.amount):"-"})]},e.id)),0===ec.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:4,className:"py-2 text-[11px] text-slate-500",children:"No deals found for Segment B."})})]})]})})]})]})]})})}}},function(e){e.O(0,[448,447,99,971,117,744],function(){return e(e.s=81451)}),_N_E=e.O()}]);